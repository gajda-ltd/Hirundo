<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../css/bootstrap.min.css" />
    <link rel="stylesheet" href="../css/styles.css" />
    <link rel="stylesheet" href="../css/offcanvas.css" />
    <link rel="stylesheet" href="../css/datatables.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/fixedheader/3.1.7/css/fixedHeader.dataTables.min.css" />

    <title>APE - Price List Final</title>
  </head>
  <body>
    <nav id="navigation" class="navbar navbar-expand-lg fixed-top navbar-dark bg-dark">
      <span class="navbar-brand mr-auto mr-lg-0" href="#"
        ><b>A</b>ssisted <b>P</b>ricing <b>E</b>nvironment</span
      >
      <button
        class="navbar-toggler p-0 border-0"
        type="button"
        data-toggle="offcanvas"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <div
        class="navbar-collapse offcanvas-collapse"
        id="navbarsExampleDefault"
      >
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="../index.html">Summary</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="./overview.html">Detailed Variance Analysis</a>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="./pricelistfinal.html"
              >Price List Final <span class="sr-only">(current)</span></a
            >
            <li class="nav-item"><a class="nav-link" href="./GeneralInformation.html">Input - General Information</a></li>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="./TEWU.html">Input - Vehicles</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="./alloptions.html">Input - Options</a>
          </li>
        </ul>
      </div>
    </nav>
    <div class="container-fluid">
      <div class="row">
        <div class="col">
          <!-- z tego można pomyśleć czy nie zrobić <header> -->
          <h1>Price List Final</h1>
          <p class="text-monospace">
            <mark>Table creation date:</mark>
            <time datetime="2020-05-20">20.05.2020</time>
          </p>
          <p class="text-monospace">
            <mark>VOG reference date:</mark>
            <time datetime="2020-05-10">10.05.2020</time>
          </p>
          <!-- </header> -->
        </div>
      </div>

      <div class="row">
        <div class="col">
          <form action="">
            <div class="row">
              <div class="form-group col-12 col-sm-6 col-md-3">
                <!-- TODO dodać value do wszystkich selectów -->
                <label for="country">Country</label>
                <select class="form-control" id="country">
                  <option>Switzerland</option>
                  <option>Ireland</option>
                  <option>Scotland</option>
                  <option>Portugal</option>
                  <option>Poland</option>
                </select>
              </div>
              <div class="form-group col-12 col-sm-6 col-md-3">
                <label for="countryGroup">Country Group</label>
                <select class="form-control" id="countryGroup">
                  <option>CA</option>
                </select>
              </div>
              <div class="form-group col-12 col-sm-6 col-md-3">
                <label for="carline">Carline</label>
                <select class="form-control" id="carline">
                  <option>Mokka</option>
                  <option>Astra</option>
                  <option>Insignia</option>
                  <option>Corsa</option>
                  <option>Crossland</option>
                </select>
              </div>
              <div class="form-group col-12 col-sm-6 col-md-3">
                <label for="vehicleBrand">Vehicle Brand</label>
                <select class="form-control" id="vehicleBrand">
                  <option>0: Opel</option>
                  <option>Vauxhall</option>
                </select>
              </div>
              <div class="form-group col-12 col-sm-6 col-md-3">
                <label for="modelYear">Model Year</label>
                <select class="form-control" id="modelYear">
                  <option>21.0A</option>
                  <option>20.0</option>
                  <option>19.0</option>
                </select>
              </div>
            </div>
          </form>
          <button id="submitButton" class="btn btn-primary">
            Submit
          </button>
        </div>
      </div>

      <!-- <div class="row">
        <div class="col-auto">
          <span class="badge badge-primary bg-info">Switzerland</span>
        </div>
        <div class="col-auto">
          <span class="badge badge-primary bg-info">Mokka</span>
        </div>
        <div class="col-auto">
          <span class="badge badge-primary bg-info">Opel</span>
        </div>
        <div class="col-auto">
          <span class="badge badge-primary bg-info">MY21.0</span>
        </div>
        <div class="col-auto">
          <span class="badge badge-primary">1,1 CHF = 1 EUR</span>
        </div>
      </div> -->

      <div class="row">
        <div class="col">
          <div class="bd-callout">
            <div class="row">
              <div class="col">
                <div class="row">
                  <div class="col">
                    <div class="tab-content">
                      <div
                        class="tab-pane fade show active"
                        role="tabpanel"
                      >
                      <div class="table-responsive">
                        <table
                          class="table table-sm table-striped table-bordered"
                          id = "generalinformation"
                        >
                        <thead class="thead-light">
                          <tr>
                            <th colspan="4"></td>
                            <th colspan="3">LP incl. Taxes</td>
                            <th colspan="3">LP excl. Taxes</td>
                            <th colspan="3">Dealer Price</td>
                            <th colspan="3">Dealer Price</td>
                            <th colspan="3">Importer Gross Margin</td>
                            <th colspan="3">Importer Gross Margin</td>
                            <th colspan="3">Importer Costs</td>
                            <th colspan="3">Importer Net Margin</td>
                            <th colspan="3">Importer Net Margin</td>
                            <th colspan="3">Gross Sales / PDU</td>
                            <th colspan="3">Country Margin</td>
                            <th colspan="3">Country Margin</td>
                            <th colspan="3">PPI</td>
                            <th colspan="3">Commercial Margin</td>
                            <th colspan="3">Commercial Margin</td>
                            <th colspan="3">Opel Support</td>
                            <th colspan="3">RBCV</td>
                          </tr>
                          <tr>
                            <th colspan="4"></td>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                            <th colspan="1"><div><span>Vehicle</span></div></th>
                            <th colspan="1"><div><span>Options</span></div></th>
                            <th colspan="1"><div><span>Total</span></div></th>
                          </tr>
                          <tr>
                            <th scope="col"><div><span>GMUD2</span></div></th>
                            <th scope="col"><div><span>LCDV</span></div></th>
                            <th scope="col"><div><span>Version Name</span></div></th>
                            <th scope="col"><div><span>Final Mix %</span></div></th>
                            <th scope="col"><div><span>LC</span></div></th>
                            <th scope="col"><div><span>LC</span></div></th>
                            <th scope="col"><div><span>LC</span></div></th>
                            <th scope="col"><div><span>LC</span></div></th>
                            <th scope="col"><div><span>LC</span></div></th>
                            <th scope="col"><div><span>LC</span></div></th>
                            <th scope="col"><div><span>LC</span></div></th>
                            <th scope="col"><div><span>LC</span></div></th>
                            <th scope="col"><div><span>LC</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>%</span></div></th>
                            <th scope="col"><div><span>%</span></div></th>
                            <th scope="col"><div><span>%</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>%</span></div></th>
                            <th scope="col"><div><span>%</span></div></th>
                            <th scope="col"><div><span>%</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>%</span></div></th>
                            <th scope="col"><div><span>%</span></div></th>
                            <th scope="col"><div><span>%</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>%</span></div></th>
                            <th scope="col"><div><span>%</span></div></th>
                            <th scope="col"><div><span>%</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                            <th scope="col"><div><span>EUR</span></div></th>
                          </tr>
                        </thead>
                      </table>
                      </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- TODO dodać na bazie nav / tablist tabele ukrywane i pokazywane w zależności od wybranego selecta: https://getbootstrap.com/docs/4.5/components/navs/#javascript-behavior -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <!-- <script src="./js/jquery-3.5.1.slim.min.js"></script> -->
    <!-- TODO: do sprawdzenia wersje jQuery, bo coś DataTables świruje przy ładowaniu wersji jQuery Bootstrapa z dysku -->

    <script src="../js/bootstrap.bundle.min.js"></script>
    <script src="../js/offcanvas.js"></script>
    <script src="../js/dataTable.jquery.js"></script>
    <script src="https://cdn.datatables.net/fixedheader/3.1.7/js/dataTables.fixedHeader.min.js"></script>
    <script>
      $(document).ready(function () {
        document.querySelector("#submitButton").addEventListener("click", (e) => {
          e.preventDefault();
          let r =
          {
            country: document.querySelector("#country").value,
            countryGroup: document.querySelector("#countryGroup").value,
            carline: document.querySelector("#carline").value,
            vehicleBrand: document.querySelector("#vehicleBrand").value,
            modelYear: document.querySelector("#modelYear").value
          };
    
          fetch('../PriceListFinal', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(r)
          })
            .then(response => response.json())
            .then(data => {
                //price list final
                $('#generalinformation').DataTable().clear().draw();
                $('#generalinformation').DataTable().rows.add(data.price_list_final);
                $('#generalinformation').DataTable().columns.adjust().draw();
 
            });
        });
      });
  
        let r =
          {
            country: document.querySelector("#country").value,
            countryGroup: document.querySelector("#countryGroup").value,
            carline: document.querySelector("#carline").value,
            vehicleBrand: document.querySelector("#vehicleBrand").value,
            modelYear: document.querySelector("#modelYear").value
          };
  
        let tableData; // placeholder for ajax tables data
          
        $.ajax({
          headers: { 
            'Accept': 'application/json',
            'Content-Type': 'application/json' 
          },
          'type': 'POST',
          'url': "../PriceListFinal",
          'data': JSON.stringify(r),
          'dataType': 'json',
          success: function (data) {
            tableData = data,
            console.log('tableData', data);
            $("#generalinformation").dataTable({
              data: data.price_list_final,
            //   fixedHeader: {
            //   header: true,
            //   headerOffset: $('#navigation').outerHeight()
            // },
              columns: [
                { "data": "codeGMUD2" },
                { "data": "codeLCDV" },
                { "data": "versionName" },
                { "data": "finalMixPercent" },
                { "data": "EURTolpIncludedTaxesVehicleInLCtalBudget" },
                { "data": "lpIncludedTaxesOptionsInLC" },
                { "data": "lpIncludedTaxesTotalInLC" },
                { "data": "lpExcludedTaxesVehicleInLC" },
                { "data": "lpExcludedTaxesOptionsInLC" },
                { "data": "lpExcludedTaxesTotalInLC" },
                { "data": "dealerPriceVehicleInLC" },
                { "data": "dealerPriceOptionsInLC" },
                { "data": "dealerPriceTotalInLC" },
                { "data": "dealerPriceVehicleInEUR" },
                { "data": "dealerPriceOptionsInEUR" },
                { "data": "dealerPriceTotalInEUR" },
                { "data": "importerGrossMarginVehicleInEUR" },
                { "data": "importerGrossMarginOptionsInEUR" },
                { "data": "importerGrossMarginTotalInEUR" },
                { "data": "importerGrossMarginVehiclePercent" },
                { "data": "importerGrossMarginOptionsPercent" },
                { "data": "importerGrossMarginTotalPercent" },
                { "data": "importerCostsVehicleInEUR" },
                { "data": "importerCostsOptionsInEUR" },
                { "data": "importerCostsTotalInEUR" },
                { "data": "importerNetMarginVehicleInEUR" },
                { "data": "importerNetMarginOptionsInEUR" },
                { "data": "importerNetMarginTotalInEUR" },
                { "data": "importerNetMarginVehiclePercent" },
                { "data": "importerNetMarginOptionsPercent" },
                { "data": "importerNetMarginTotalPercent" },
                { "data": "grossSalesPduVehicleInEUR" },
                { "data": "grossSalesPduOptionsInEUR" },
                { "data": "grossSalesPduTotalInEUR" },
                { "data": "countryMarginVehicleInEUR" },
                { "data": "countryMarginOptionsInEUR" },
                { "data": "countryMarginTotalInEUR" },
                { "data": "countryMarginVehiclePercent" },
                { "data": "countryMarginOptionsPercent" },
                { "data": "countryMarginTotalPercent" },
                { "data": "ppiVehicleInEUR" },
                { "data": "ppiOptionsInEUR" },
                { "data": "ppiTotalInEUR" },
                { "data": "cmVehicleInEUR" },
                { "data": "cmOptionsInEUR" },
                { "data": "cmTotalInEUR" },
                { "data": "cmVehiclePercent" },
                { "data": "cmOptionsPercent" },
                { "data": "cmTotalPercent" },
                { "data": "opelSupportVehicleInEUR" },
                { "data": "opelSupportOptionsInEUR" },
                { "data": "opelSupportTotalInEUR" },
                { "data": "rbcvVehicleInEUR" },
                { "data": "rbcvOptionsInEUR" },
                { "data": "rbcvTotalInEUR" },
              ],
              "columnDefs": [
              { "render": $.fn.dataTable.render.number( '.', ','),
                "targets":'_all'
              },
              ],
              error: function (error) {
                alert("Data Tables ERROR: " + error)
              }
            });
  },
          error: function (error) {
            alert("AJAX ERROR: " + error)
          },
        });
              
    </script>

    <!-- Option 2: jQuery, Popper.js, and Bootstrap JS
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    -->
  </body>
</html>
